<!DOCTYPE html>
<html>
<head>
  <title>Quiz Master</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <!-- Firebase Config -->
  <script src="firebase.js"></script>
</head>

<body style="font-family:Arial; text-align:center; padding:20px;">

<h2>Quiz Master Dashboard</h2>

<button onclick="createRoom()">Create New Room</button>

<h3 id="roomCode"></h3>
<hr>

<h3>Create Teams</h3>

<input id="teamName" placeholder="Team Name">
<button onclick="addTeam()">Add Team</button>

<ul id="teamList"></ul>
<script>
let currentRoom = null;

function createRoom() {
  const code = Math.random().toString(36).substring(2, 6).toUpperCase();
  currentRoom = code;

  document.getElementById("roomCode").innerText =
    "Room Code: " + code;

  firebase.database().ref("rooms/" + code).set({
    status: "waiting",
    createdAt: Date.now(),
    teams: {}
  });

  listenForTeams();
}

function addTeam() {
  alert("Add Team button clicked");

  const name = document.getElementById("teamName").value.trim();
  alert("Team name: " + name);

  if (!currentRoom) {
    alert("Room not created yet");
    return;
  }

  firebase.database()
    .ref("rooms/" + currentRoom + "/teams/" + name)
    .set({ score: 0 })
    .then(() => {
      alert("Team saved to Firebase");
    })
    .catch(err => {
      alert("Firebase error: " + err.message);
    });
}

function listenForTeams() {
  firebase.database()
    .ref("rooms/" + currentRoom + "/teams")
    .on("value", snapshot => {
      const teams = snapshot.val() || {};
      const list = document.getElementById("teamList");
      list.innerHTML = "";
      Object.keys(teams).forEach(team => {
        const li = document.createElement("li");
        li.innerText = team;
        list.appendChild(li);
      });
    });
}
</script>


</body>
</html>
